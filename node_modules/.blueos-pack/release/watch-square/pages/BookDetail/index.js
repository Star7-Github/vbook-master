let l={"@info":{styleObjectId:1227805737}};const p=l,s=$app_require$("@app-module/system.router"),a=$app_require$("@app-module/system.prompt"),i=$app_require$("@app-module/system.file"),r={data:function(){return{bookId:"",bookName:"",chapterCount:0,currentChapter:0,rawUri:"",isLocal:!1,content:"",isDeleting:!1,showDeleteAlert:!1,alertButtons:[{eventType:"confirm",type:"danger",value:"删除"},{eventType:"cancel",type:"plain",value:"取消"}]}},onInit(){console.log("书籍详情页 初始化",this.bookName),typeof this.isLocal=="string"&&(this.isLocal=this.isLocal==="true")},computed:{progressPercent(){const e=Number(this.currentChapter)||0,o=Number(this.chapterCount)||1;if(o<=0)return 0;let t=Math.floor((e+1)*100/o);return t>100&&(t=100),t}},startReading(){this.isLocal?s.push({uri:"pages/Reader",params:{title:this.bookName,content:this.content,bookId:"local_"+this.bookName}}):s.push({uri:"pages/Reader",params:{bookId:this.bookId,bookName:this.bookName,chapterIndex:this.currentChapter,chapterCount:this.chapterCount}})},handleDelete(){if(this.isLocal){a.showToast({message:"内置书籍无法删除"});return}this.showDeleteAlert=!0},onAlertClick(e){this.showDeleteAlert=!1,e.detail&&e.detail.eventType==="confirm"&&this.confirmDelete()},stopPropagation(e){e.stopPropagation&&e.stopPropagation()},confirmDelete(){this.isDeleting=!0,this.doDeleteFiles()},doDeleteFiles(){if(this.rawUri&&i.delete({uri:this.rawUri,success:()=>console.log("Deleted meta"),fail:(e,o)=>console.log("Delete meta failed",o)}),this.bookId){const e=`internal://files/book_data_${this.bookId}`;i.rmdir({uri:e,recursive:!0,success:()=>console.log("Deleted content folder"),fail:(o,t)=>console.log("Delete folder failed",t)})}this.$app&&this.$app.$def&&this.$app.$def.clearTask&&this.$app.$def.clearTask(this.bookId),setTimeout(()=>{this.isDeleting=!1,a.showToast({message:"删除成功"}),s.back()},800)}};$app_define$("@app-component/index",[],function(e,o,t){t.exports=r.default||r,t.exports.style=p});$app_bootstrap$("@app-component/index");
